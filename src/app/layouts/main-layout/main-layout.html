<div class="h-full flex bg-gray-100">
    <div [ngClass]="isSidebarCollapsed ? 'w-[60px]' : 'w-[300px]'"
        class="transition-all duration-300 shadow-md bg-white overflow-visible">
        <div class="h-[68px] bg-[#00A6E6]">
            <img [src]="isSidebarCollapsed ? 'assets/images/ktb_logo_crop.png' : 'assets/images/ktb_logo_1.png'"
                alt="ktb_logo" class="h-full mx-auto" />
        </div>
        <div class="bg-blue-700 h-10 flex items-center justify-center gap-2">
            <app-icon [name]="menus.icon" size="25" class="text-white" [ariaLabel]="menus.title"></app-icon>

            @if(!isSidebarCollapsed) {
            <span class="text-white text-sm font-semibold">{{menus.title}}</span>
            }
        </div>

        @if(!isSidebarCollapsed) {
        <ul class="menu menu-md rounded-box w-full p-0">
            <app-menu-item *ngFor="let menu of menus.submenu" [menu]="menu" [isParent]="true">
            </app-menu-item>
        </ul>
        }
        @else {
        <div class="flex flex-col items-center sidebar-menu">
            <ul class="menu p-0 w-full">
                <li *ngFor="let menu of menus.submenu" class="relative group w-full">
                    <!-- Parent menu -->
                    <button class="w-full h-12 flex items-center justify-center gap-2 px-2" (click)="toggleMenu(menu)">
                        <app-icon [name]="menu.icon" size="25" [ariaLabel]="menu.title"></app-icon>
                    </button>
                    @if(isSidebarCollapsed && !openedMenu) {
                    <!-- Tooltip สำหรับ collapsed sidebar -->
                    <div
                        class="absolute left-full top-1/2 transform -translate-y-1/2 ml-2 bg-gray-800 text-white text-xs rounded px-2 py-1 opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap z-50">
                        {{ menu.title }}
                    </div>
                    }

                    <!-- Submenu แสดงใต้เมนู -->
                    <ul *ngIf="openedMenu === menu"
                        class="absolute left-0 top-full p-2 min-w-64 bg-white shadow rounded-md z-50">
                        <li *ngFor="let child of menu.submenu; let last = last" class="relative pl-4 
             before:content-[''] before:absolute before:left-0 before:top-1/2 before:w-4
             before:border-t before:border-dashed before:border-blue-300
             after:content-[''] after:absolute after:left-0 after:top-0 after:bottom-0
             after:border-l after:border-dashed after:border-blue-300" [ngClass]="{ 'after:bottom-1': last }">
                            <span class="text-sm py-2">{{ child.title }}</span>
                        </li>
                    </ul>
                </li>
            </ul>
        </div>

        }
    </div>
    <div class="flex-1">
        <div class="flex px-6 items-center bg-gradient-to-r from-[#00A6E6] to-[#007BAA] h-[68px]">
            <div class="flex w-64 justify-between items-center">
                <div class="px-2">
                    <button class="hidden md:block z-50 p-1 cursor-pointer" (click)="toggleSidebar()">
                        <app-icon name="burger-menu" size="25" class="text-blue-100" ariaLabel="burger-menu"></app-icon>
                    </button>
                </div>
                <div>
                    <p class="text-white text-2xl font-bold">Budget Prep. Tool</p>
                </div>
            </div>
            <div class="flex-1 flex justify-end gap-4 items-center px-2">
                <app-icon name="notification-bell" size="30" class="text-white"
                    ariaLabel="notification-bell"></app-icon>
                <div class="dropdown dropdown-end cursor-pointer">
                    <div class="flex items-center gap-2" tabindex="0">
                        <app-icon name="profile" size="35" class="text-white" ariaLabel="profile"></app-icon>
                        <div>
                            <p class="text-sm font-medium text-white">สมคิด พัฒนาอุตสาหกิจ</p>
                            <p class="text-xs font-medium text-blue-200">ฝ่ายวางแผนและงบประมาณ</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>


        <div class="h-10 bg-white shadow-md">
            <ul class="flex items-center px-8 h-full">
                <li *ngFor="let item of menuItems; let i = index" class="py-2 px-6 flex items-center gap-0.5">
                    <app-icon [name]="item.icon" size="20"
                        [ngClass]="isActive(item.path) ? 'text-blue-400' : 'text-gray-700'"
                        [ariaLabel]="item.title"></app-icon>
                    <a class="text-sm font-medium" [ngClass]="isActive(item.path) ? 'text-blue-400' : 'text-gray-700'"
                        [routerLink]="item.path">{{ item.title }}</a>
                </li>
            </ul>
        </div>

        <div class="px-8 py-4">
            <div class="breadcrumbs text-sm">
                <ul>
                    <li><a>Home</a></li>
                    <li><a>Documents</a></li>
                    <li>Add Document</li>
                </ul>
            </div>
            <div class="px-4 py-6 bg-white rounded-md shadow-sm min-h-[calc(100vh-184px)]">
                <router-outlet />
            </div>
        </div>
    </div>
</div>